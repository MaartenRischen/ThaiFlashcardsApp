# Development Log

## Usability Improvements

### 2024-XX-XX: Implemented Targeted Supabase Image Optimization
- Fixed image optimization to ONLY apply to Supabase-stored set images:
  - Created a very simple custom loader that only transforms Supabase storage URLs
  - All other images (wizard images, UI components, logos) use default rendering
  - The loader explicitly checks for "supabase.co/storage/v1/object/public/set-images" pattern
  - Only images matching this pattern get transformed, everything else is returned as-is
- This approach provides:
  - Bandwidth savings for set images generated by Ideogram
  - Faster loading times for the gallery pages
  - No impact on wizard UI, illustrations, or any other app images
  - Maintains full compatibility with all existing functionality

### 2024-XX-XX: Reverted Image Optimization Changes
- Encountered issues with missing wizard images after implementing Supabase image optimization
- Reverted all changes to restore original image loading functionality:
  - Removed custom image loader from Next.js configuration
  - Set `unoptimized: true` to revert to default Next.js image handling
  - Created a backup of the custom loader for potential future use
- This ensures all images appear correctly throughout the app, including:
  - Wizard selection images
  - Level illustrations
  - UI elements
- Will investigate alternative approaches for optimizing Ideogram-generated images without affecting other images

### 2024-XX-XX: Implemented Selective Supabase Image Optimization
- Added selective image optimization capabilities using Supabase's image transformation feature
- Created a custom Next.js image loader for Supabase in `lib/supabase-image-loader.js`
- IMPORTANT: Only applies to Ideogram-generated set images, preserving all other images
- Modified optimization code to specifically target only set-images from Supabase:
  - Added filter logic to skip any non-set-images or default logo images
  - Ensured UI images, icons, and other assets remain untouched
  - Avoided breaking existing images throughout the app
- This selective approach:
  - Reduces bandwidth usage for set cover images only
  - Improves loading performance for the sets gallery
  - Doesn't interfere with existing image display across the app

### 2024-XX-XX: Upgraded to Ideogram v3 API for Text-Free Images
- Upgraded the image generation to use the latest Ideogram v3 API for better quality and control
- Implemented comprehensive text prevention measures:
  - Moved from the legacy API to the new v3 endpoint (https://api.ideogram.ai/v1/ideogram-v3/generate)
  - Updated to use multipart/form-data format as required by the v3 API
  - Configured the API with appropriate style_type (GENERAL) and rendering_speed (QUALITY) parameters
  - Enhanced the negative prompt to comprehensively prevent any type of text
  - Added explicit text prohibition in the main prompt
  - Updated all test scripts to use the same API version and parameters
- These changes should eliminate text from appearing in generated images completely

### 2024-XX-XX: Toast Notification Improvements
- Investigated making toast notifications dismissable with the closeButton property
- Encountered compatibility issues with Next.js 14.2.28 and Sonner 2.0.3
- Implemented a more compatible solution using auto-dismissal:
  - Added global default duration of 5 seconds to all toasts via the Toaster component
  - Set specific durations for different types of notifications:
    - Standard success/error notifications: 5 seconds
    - Informational notifications: 10 seconds
    - Loading notifications still use infinite duration
  - Replaced alert() calls with toast notifications for a more consistent user experience
- This approach allows users to see notifications without interrupting their workflow, while ensuring notifications don't stay on screen indefinitely 